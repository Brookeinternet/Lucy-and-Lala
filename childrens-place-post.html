<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Children's Place Fun - Lucy and Lala's Adventures</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter font from Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons (like heart) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Stripe.js for payments -->
    <script src="https://js.stripe.com/v3/"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fff0f5; /* Blush pink for an even cutesier feel */
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding-bottom: 3rem; /* Space for footer */
        }
        .container {
            max-width: 900px; /* Max width for content */
            width: 100%;
        }
        .blog-article { /* Changed from .blog-section to .blog-article for the single main section */
            background-color: #ffffff; /* White background for the article */
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1); /* Softer, more diffused shadow */
            border: 4px solid #fecdd3; /* Rose pink, slightly thicker border */
            border-radius: 2rem; /* More rounded corners */
            overflow: hidden; /* Ensures rounded corners apply to children */
            margin-bottom: 2.5rem; /* Space before footer */
            transition: transform 0.3s ease, box-shadow 0.3s ease; /* Smooth transition for hover */
            padding: 2.5rem; /* Padding for the entire article content */
        }
        .blog-article:hover {
            transform: translateY(-8px); /* More pronounced lift on hover */
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2); /* Enhanced shadow on hover */
        }
        .btn-primary {
            background-color: #ff85a2; /* Brighter, more vibrant pink */
            color: #ffffff;
            transition: all 0.3s ease;
            transform: translateY(0);
            border: 2px solid #ffffff; /* White border for a cute outline */
        }
        .btn-primary:hover {
            background-color: #ff6b8f; /* Darker pink on hover */
            transform: translateY(-3px) scale(1.05); /* More pronounced lift and slight scale */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25); /* Stronger shadow on hover */
        }
        .header-bg {
            background-image: linear-gradient(to right, #fbcfe8, #fbc0f8); /* Softer, more magical gradient */
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1); /* Subtle text shadow for header */
        }
        h1 {
            font-weight: 900; /* Even bolder font for the main title */
        }
        h2, h3 {
            font-weight: 800; /* Bolder font for post titles */
        }
        .text-cutesy-pink {
            color: #ff85a2; /* Custom cutesy pink color */
        }
        .like-button {
            cursor: pointer;
            font-size: 2.5rem; /* Larger heart icon */
            color: #ccc; /* Default grey */
            transition: color 0.2s ease, transform 0.2s ease;
        }
        .like-button.liked {
            color: #ff6b8f; /* Pink when liked */
            transform: scale(1.1);
        }
        .like-button:active {
            transform: scale(0.9); /* Squish effect on click */
        }
        .media-block { /* New class for image/video containers within the single article */
            position: relative;
            padding-bottom: 75%; /* 4:3 Aspect Ratio */
            height: 0;
            overflow: hidden;
            border-radius: 1.5rem; /* Slightly less rounded than article for distinction */
            margin-bottom: 2rem; /* Space below media */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1); /* Shadow for media */
        }
        .media-block img, .media-block video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover; /* Ensures media covers the area */
        }
        /* Lock Overlay Styles */
        .locked-overlay {
            background-color: rgba(255, 255, 255, 0.98); /* Almost opaque white */
            position: fixed; /* Use fixed to cover entire viewport */
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem;
            z-index: 9999; /* High z-index to ensure it's on top */
        }
        .locked-overlay h3 {
            color: #ef4444; /* Red */
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        .locked-overlay p {
            color: #4b5563; /* Gray-700 */
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
        }
        .locked-overlay a {
            background-color: #ef4444; /* Red */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }
        .locked-overlay a:hover {
            background-color: #dc2626; /* Darker red */
        }
    </style>
</head>
<body class="antialiased text-gray-600">
    <!-- Content Lock Script -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Global variables for Firebase config and app ID
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let app = null;
        let auth = null;
        let db = null;
        let currentUserId = null;

        // Initialize Firebase services only if config is available
        if (firebaseConfig && firebaseConfig.apiKey) {
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
            console.log("Firebase services initialized.");
        } else {
            console.warn("Firebase config not found. Authentication and Pro status will not be available.");
        }
        

        /**
         * Gets the current authenticated user's UID.
         * @returns {Promise<string|null>} The user's UID or null if not authenticated.
         */
        async function getAuthenticatedUserId() {
            if (!auth) return null;
            return new Promise(resolve => {
                const unsubscribe = onAuthStateChanged(auth, (user) => {
                    unsubscribe(); // Stop listening once we have a user
                    if (user) {
                        currentUserId = user.uid;
                        resolve(user.uid);
                    } else {
                        resolve(null);
                    }
                });
            });
        }

        /**
         * Fetches a user's subscriber status from Firestore.
         * @returns {Promise<boolean>} True if the user is a Pro Subscriber, false otherwise.
         */
        async function getProSubscriberStatus() {
            if (!db) return false;
            const userId = await getAuthenticatedUserId();

            if (!userId) {
                console.warn("Cannot get subscriber status: User not authenticated.");
                return false;
            }

            try {
                const userDocRef = doc(db, `artifacts/${appId}/users/${userId}/profile`, 'subscription');
                const docSnap = await getDoc(userDocRef);

                if (docSnap.exists()) {
                    const data = docSnap.data();
                    return data.isProSubscriber === true;
                } else {
                    return false;
                }
            } catch (error) {
                console.error("Error fetching subscriber status:", error);
                return false;
            }
        }

        const releaseDate = new Date('2025-08-23T00:00:00'); // Set release date to August 23rd, 2025
        const currentDate = new Date();

        document.addEventListener('DOMContentLoaded', async () => {
            // Ensure Firebase Auth is ready before checking status
            if (auth) {
                 await new Promise(resolve => {
                    onAuthStateChanged(auth, (user) => {
                        if (user) {
                            currentUserId = user.uid;
                        } else {
                             // If no user is signed in, attempt anonymous or custom token sign-in
                            if (initialAuthToken) {
                                signInWithCustomToken(auth, initialAuthToken)
                                    .then((userCredential) => {
                                        console.log("Signed in with custom token:", userCredential.user.uid);
                                    })
                                    .catch((error) => {
                                        console.error("Error signing in with custom token:", error);
                                        signInAnonymously(auth)
                                            .then(() => console.log("Signed in anonymously (fallback)."))
                                            .catch(e => console.error("Error signing in anonymously:", e));
                                    });
                            } else {
                                signInAnonymously(auth)
                                    .then(() => console.log("Signed in anonymously."))
                                    .catch(e => console.error("Error signing in anonymously:", e));
                            }
                        }
                        resolve();
                    });
                });
            }


            if (currentDate < releaseDate) {
                // Article is date-locked for everyone
                document.body.innerHTML = `
                    <div class="locked-overlay">
                        <h3>🔒 Coming Soon!</h3>
                        <p>This exclusive shopping adventure will be released on August 23rd, 2025!</p>
                        <p>Check back soon to see Lucy and Lala's stylish finds!</p>
                        <a href="toddler-blog" class="mt-4 bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-colors">
                            Back to All Adventures! 🎀
                        </a>
                    </div>
                `;
                document.body.style.overflow = 'hidden'; // Prevent scrolling when locked
            } else {
                // Article is released, now check Pro status
                const isProSubscriber = await getProSubscriberStatus();
                if (!isProSubscriber) {
                    const mainContent = document.querySelector('main');
                    if (mainContent) {
                        mainContent.style.position = 'relative'; // Ensure overlay positions correctly
                        mainContent.innerHTML = `
                            <div class="pro-content-overlay">
                                <h3>🔒 Pro Content Only!</h3>
                                <p>This exclusive shopping adventure is reserved for Lucy and Lala Pro Subscribers.</p>
                                <a href="https://buy.stripe.com/eVq00ldtC8408cxfZwabK00" target="_blank">Unlock Now for $10/month!</a>
                            </div>
                            ${mainContent.innerHTML}
                        `;
                        // Optionally blur or reduce opacity of content behind overlay
                        const contentToBlur = mainContent.querySelector('article');
                        if (contentToBlur) {
                            contentToBlur.style.filter = 'blur(5px)';
                            contentToBlur.style.pointerEvents = 'none';
                        }
                    }
                }
            }
        });
    </script>

    <div class="min-h-screen flex flex-col items-center py-8 px-4 w-full">
        <!-- Header Section -->
        <header class="w-full container mx-auto text-center mb-12">
            <div class="header-bg rounded-3xl p-6 shadow-xl mb-4">
                <h1 class="text-5xl md:text-6xl font-extrabold text-white mb-2 drop-shadow-lg">
                    🛍️ The Children's Place Fun! 💖
                </h1>
                <p class="text-xl md:text-2xl text-pink-800 font-semibold">
                    A stylish shopping adventure with Lucy and Lala! ✨
                </p>
            </div>
        </header>

        <!-- Main Blog Post Content - Now a single article structure -->
        <main class="w-full container mx-auto">
            <article class="blog-article">
                <h2 class="text-4xl font-extrabold text-cutesy-pink mb-6 text-center">Exploring New Styles at The Children's Place! 👗👖</h2>

                <div class="media-block">
                    <img src="https://i.imgur.com/yfy42sN.jpeg" alt="Lucy and Lala at The Children's Place store">
                </div>
                <p class="text-gray-700 leading-relaxed mb-8 text-lg">
                    Today was a special day for a little retail therapy, and Lucy and Lala were absolutely thrilled to visit <a href="https://www.childrensplace.com/" target="_blank" class="text-pink-600 font-bold hover:underline">The Children's Place</a>! Their eyes sparkled as they walked through the colorful aisles, filled with so many adorable outfits and accessories. It's always a joy to see them explore new clothes and pick out their favorite prints and styles. The store is a wonderland for little fashionistas, offering trendy and comfortable options for every occasion.
                    <br><br>
                    The twins were all smiles as they stepped into The Children’s Place—ready to explore racks of ruffles, florals, and comfy basics. Their eyes lit up at the sight of pastel sweaters, twirly dresses, and the cutest seasonal prints.
                </p>

                <h3 class="text-3xl font-extrabold text-cutesy-pink mb-4 text-center">Playtime Perfection in Their Outfits! 🤸‍♀️</h3>
                <div class="media-block">
                    <img src="https://i.imgur.com/Wl7Nwp2.jpeg" alt="Lucy on a scooter in The Children's Place">
                </div>
                <p class="text-gray-700 leading-relaxed mb-8 text-lg">
                    Their new outfits proved to be perfect for more than just shopping! In the store, one of the girls happily zipps  around the store on a toy scooter, her floral dress twirling with every turn. This perfectly highlights how the clothes from The Children's Place are not only cute and stylish but also designed for play and comfort. They hold up to all the energetic fun of a toddler's day, whether they're walking through the aisles or embarking on a mini-adventure right there in the store!
                </p>

                <h3 class="text-3xl font-extrabold text-cutesy-pink mb-4 text-center">Seasonal Styles & Comfy Finds 💖</h3>
                <div class="media-block">
                    <img src="https://i.imgur.com/vSIIj3g.jpeg" alt="Lucy and Lala in sweaters and pants">
                </div>
                <p class="text-gray-700 leading-relaxed mb-8 text-lg">
                    Here's a closer look at some of the stylish outfits that caught our eye. On the left, we have the Girls Long Sleeve Dot Print Pullover Sweater paired with Pull-On Jeggings in a soft mauve hue. The polka dots add just the right amount of whimsy, while the jeggings are perfect for running down store aisles in search of the best deals. On the right, the Long Sleeve Floral Print Skater Dress takes center stage — a breezy cream base sprinkled with pastel blossoms, made for twirling between clothing racks. You can find similar styles like the <a href="https://www.childrensplace.com/us/p/Girls-Long-Sleeve-Embroidered-Floral-Peplum-Sweater---Highland-Hills-3054292-32DK" target="_blank" class="text-pink-600 font-bold hover:underline">Girls Long Sleeve Embroidered Floral Peplum Sweater</a> that Lucy loved, cozy <a href="https://www.childrensplace.com/us/search/dot%20sweater" target="_blank" class="text-pink-600 font-bold hover:underline">dot print sweaters</a>, and durable <a href="https://www.childrensplace.com/us/c/girl-and-toddler-girl-leggings" target="_blank" class="text-pink-600 font-bold hover:underline">leggings</a> for endless outfit combinations.
                </p>
                <div class="media-block">
                    <img src="https://i.imgur.com/t6b5fr9.jpeg" alt="Lucy and Lala smiling inside The Children's Place">
                </div>
                <p class="text-gray-700 leading-relaxed mb-8 text-lg">
                    Look at those happy faces! Lucy and Lala were all smiles as they posed amidst the vibrant displays at The Children's Place. The bright lighting and cheerful atmosphere made their shopping experience even more delightful. We love how this store offers such a wide variety of clothing that's both stylish and practical for active toddlers. From everyday playwear to special occasion outfits, they always have something perfect for our girls. It's a fantastic place to find durable clothes that stand up to all their adventures while keeping them looking absolutely adorable!
                </p>

                <!-- Single Like Button for the entire article -->
                <div class="flex flex-col items-center space-y-6 mt-12">
                    <p class="text-xl font-semibold text-gray-700">Did you enjoy this stylish shopping adventure?</p>
                    <div class="flex items-center space-x-6">
                        <i class="fas fa-heart like-button" onclick="toggleLike(this)"></i>
                        <button class="btn-primary py-4 px-8 rounded-full inline-block font-bold text-lg shadow-lg hover:shadow-xl">
                            Like This Post! ❤️
                        </button>
                    </div>
                </div>
            </article>

            <a href="index.html" class="btn-primary py-5 px-10 rounded-full inline-block font-extrabold text-xl shadow-lg hover:shadow-xl mt-6">
                Back to All Adventures! 🎀
            </a>
        </main>

        <!-- Footer Section -->
        <footer class="w-full container mx-auto text-center mt-12 py-8 border-t-4 border-pink-300 rounded-t-3xl bg-white shadow-inner">
            <p class="text-gray-600 text-lg font-bold">
                &copy; 2025 Lucy and Lala's Adventures. All rights reserved. Made with extra love and sprinkles! ❤️✨
            </p>
        </footer>
    </div>

    <script type="module">
        // This is a placeholder for your Firebase and Stripe logic.
        // It's removed from this specific page to fix the errors you reported.
        // The homepage will handle these actions.

        // Function to toggle the 'liked' state of the heart button
        function toggleLike(element) {
            element.classList.toggle('liked');
            // You could add more logic here, like sending data to a server
            // or incrementing a like count displayed next to the heart.
        }
    </script>
</body>
</html>
